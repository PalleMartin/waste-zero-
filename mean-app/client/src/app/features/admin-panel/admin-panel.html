<div class="admin-panel-container" [class.dark-mode]="isDarkMode">
  <!-- Top Navigation Bar -->
  <header class="top-nav">
    <div class="nav-left">
      <div class="logo">
        <img src="assets/logo-img.png" alt="WasteZero" class="logo-img">
        <span class="logo-text">WasteZero</span>
      </div>
    </div>
    
    <div class="nav-center">
      <div class="search-container">
        <input type="text" placeholder="Search pickups, opportunities..." class="search-input">
        <i class="search-icon">üîç</i>
      </div>
    </div>
    
    <div class="nav-right">
      <button class="nav-icon" title="Notifications">
        <i>üîî</i>
      </button>
      <button class="nav-icon" title="Profile">
        <i>‚ñº</i>
      </button>
    </div>
  </header>

  <div class="main-content">
    <!-- Left Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-section">
        <h3 class="section-title">MAIN MENU</h3>
        <nav class="sidebar-nav">
          <a href="#" class="nav-item">
            <i class="nav-icon">‚äû</i>
            <span>Dashboard</span>
          </a>
          <a href="#" class="nav-item">
            <i class="nav-icon">üìÖ</i>
            <span>Schedule Pickup</span>
          </a>
          <a href="#" class="nav-item">
            <i class="nav-icon">ü§ù</i>
            <span>Opportunities</span>
          </a>
          <a href="#" class="nav-item">
            <i class="nav-icon">üí¨</i>
            <span>Messages</span>
          </a>
          <a href="#" class="nav-item">
            <i class="nav-icon">üå±</i>
            <span>My Impact</span>
          </a>
        </nav>
      </div>
      
      <div class="sidebar-section">
        <h3 class="section-title">SETTINGS</h3>
        <nav class="sidebar-nav">
          <a href="#" class="nav-item">
            <i class="nav-icon">üë§</i>
            <span>My Profile</span>
          </a>
          <a href="#" class="nav-item">
            <i class="nav-icon">‚öôÔ∏è</i>
            <span>Settings</span>
          </a>
          <a href="#" class="nav-item">
            <i class="nav-icon">‚ùì</i>
            <span>Help & Support</span>
          </a>
          <a href="#" class="nav-item active">
            <i class="nav-icon">üõ°Ô∏è</i>
            <span>Admin Panel</span>
          </a>
        </nav>
      </div>
      
      <div class="dark-mode-toggle">
        <button class="toggle-btn" (click)="toggleDarkMode()">
          <i class="toggle-icon" [class.sun]="!isDarkMode" [class.moon]="isDarkMode">
            {{ isDarkMode ? 'üåô' : '‚òÄÔ∏è' }}
          </i>
          <span>Dark Mode</span>
        </button>
      </div>
    </aside>

    <!-- Main Content Area -->
    <main class="content-area">
      <!-- Messages -->
      <div class="messages" *ngIf="errorMessage || successMessage">
        <div class="error-message" *ngIf="errorMessage" (click)="clearMessages()">
          {{ errorMessage }}
          <button class="close-btn">√ó</button>
        </div>
        <div class="success-message" *ngIf="successMessage" (click)="clearMessages()">
          {{ successMessage }}
          <button class="close-btn">√ó</button>
        </div>
      </div>

      <!-- Admin Dashboard Header -->
      <div class="dashboard-header">
        <h1>Admin Dashboard</h1>
        <p>Manage platform users, monitor activity, and generate reports</p>
        <button class="btn btn-secondary" (click)="createSampleData()" [disabled]="isLoading">
          Create Sample Data
        </button>
      </div>

      <!-- Dashboard Statistics Cards -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon">üë•</div>
          <div class="stat-content">
            <h3>{{ dashboardStats.totalUsers }}</h3>
            <p>Total Users</p>
          </div>
        </div>
        
        <div class="stat-card">
          <div class="stat-icon completed">‚úÖ</div>
          <div class="stat-content">
            <h3>{{ dashboardStats.completedPickups }}</h3>
            <p>Completed Pickups</p>
          </div>
        </div>
        
        <div class="stat-card">
          <div class="stat-icon pending">‚è∞</div>
          <div class="stat-content">
            <h3>{{ dashboardStats.pendingPickups }}</h3>
            <p>Pending Pickups</p>
          </div>
        </div>
        
        <div class="stat-card">
          <div class="stat-icon opportunities">üìÑ</div>
          <div class="stat-content">
            <h3>{{ dashboardStats.activeOpportunities }}</h3>
            <p>Active Opportunities</p>
          </div>
        </div>
      </div>

      <!-- Generate Reports Section -->
      <div class="reports-section">
        <div class="section-header">
          <h2>Generate Reports</h2>
          <p>Download platform statistics and activity reports</p>
        </div>
        
        <div class="report-buttons">
          <button class="report-btn" (click)="generateUsersReport()" [disabled]="isLoading">
            <i class="report-icon">üë§</i>
            <span>Users Report</span>
          </button>
          
          <button class="report-btn" (click)="generatePickupsReport()" [disabled]="isLoading">
            <i class="report-icon">‚úÖ</i>
            <span>Pickups Report</span>
          </button>
          
          <button class="report-btn" (click)="generateOpportunitiesReport()" [disabled]="isLoading">
            <i class="report-icon">üìÑ</i>
            <span>Opportunities Report</span>
          </button>
          
          <button class="report-btn" (click)="generateFullActivityReport()" [disabled]="isLoading">
            <i class="report-icon">üì•</i>
            <span>Full Activity Report</span>
          </button>
        </div>
      </div>

      <!-- Tabs -->
      <div class="tabs-container">
        <div class="tabs">
          <button class="tab" [class.active]="activeTab === 'users'" (click)="setActiveTab('users')">
            Manage Users
          </button>
          <button class="tab" [class.active]="activeTab === 'logs'" (click)="setActiveTab('logs')">
            Admin Logs
          </button>
        </div>

        <!-- Users Tab Content -->
        <div class="tab-content" *ngIf="activeTab === 'users'">
          <div class="section-header">
            <h2>Users</h2>
            <p>Manage user accounts and permissions</p>
          </div>
          
          <div class="search-container">
            <input 
              type="text" 
              placeholder="Search users..." 
              [(ngModel)]="userSearchTerm"
              (input)="searchUsers()"
              class="search-input">
            <i class="search-icon">üîç</i>
          </div>

          <!-- User Edit Modal -->
          <div class="modal-overlay" *ngIf="isEditingUser" (click)="cancelEdit()">
            <div class="modal" (click)="$event.stopPropagation()">
              <div class="modal-header">
                <h3>Edit User</h3>
                <button class="close-btn" (click)="cancelEdit()">√ó</button>
              </div>
              <div class="modal-body" *ngIf="selectedUser">
                <form (ngSubmit)="saveUser()">
                  <div class="form-group">
                    <label>Name</label>
                    <input type="text" [(ngModel)]="selectedUser.name" name="name" required>
                  </div>
                  <div class="form-group">
                    <label>Email</label>
                    <input type="email" [(ngModel)]="selectedUser.email" name="email" required>
                  </div>
                  <div class="form-group">
                    <label>Role</label>
                    <select [(ngModel)]="selectedUser.role" name="role">
                      <option value="user">User</option>
                      <option value="admin">Admin</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label>Location</label>
                    <input type="text" [(ngModel)]="selectedUser.location" name="location">
                  </div>
                  <div class="form-group">
                    <label>Bio</label>
                    <textarea [(ngModel)]="selectedUser.bio" name="bio" rows="3"></textarea>
                  </div>
                  <div class="form-actions">
                    <button type="button" class="btn btn-secondary" (click)="cancelEdit()">Cancel</button>
                    <button type="submit" class="btn btn-primary" [disabled]="isLoading">Save Changes</button>
                  </div>
                </form>
              </div>
            </div>
          </div>

          <!-- Users Table -->
          <div class="table-container">
            <table class="users-table">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Email</th>
                  <th>Role</th>
                  <th>Location</th>
                  <th>Joined</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let user of filteredUsers">
                  <td>
                    <div class="user-info">
                      <div class="user-avatar">{{ user.name.charAt(0).toUpperCase() }}</div>
                      <span>{{ user.name }}</span>
                    </div>
                  </td>
                  <td>{{ user.email }}</td>
                  <td>
                    <span class="role-badge" [class.admin]="user.role === 'admin'">
                      {{ user.role }}
                    </span>
                  </td>
                  <td>{{ user.location || 'N/A' }}</td>
                  <td>{{ formatDate(user.createdAt) }}</td>
                  <td>
                    <div class="action-buttons">
                      <button class="btn btn-sm btn-primary" (click)="editUser(user)">
                        Edit
                      </button>
                      <button class="btn btn-sm btn-danger" (click)="deleteUser(user)">
                        Delete
                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
            
            <div class="no-data" *ngIf="filteredUsers.length === 0">
              <p>No users found</p>
            </div>
          </div>
        </div>

        <!-- Admin Logs Tab Content -->
        <div class="tab-content" *ngIf="activeTab === 'logs'">
          <div class="section-header">
            <h2>Admin Logs</h2>
            <p>View recent admin actions and system logs</p>
          </div>
          
          <div class="logs-container">
            <div class="log-item" *ngFor="let log of adminLogs">
              <div class="log-icon">üìù</div>
              <div class="log-content">
                <div class="log-action">{{ log.action }}</div>
                <div class="log-details">
                  <span class="log-target">Target ID: {{ log.target_id }}</span>
                  <span class="log-admin">Admin ID: {{ log.admin_id }}</span>
                  <span class="log-time">{{ formatDate(log.timestamp) }}</span>
                </div>
              </div>
            </div>
            
            <div class="no-data" *ngIf="adminLogs.length === 0">
              <p>No admin logs found</p>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>
